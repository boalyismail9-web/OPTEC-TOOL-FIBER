<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OPTEC-TOOL-FIBER</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  </head>
<body>
  <div id="app">
    <header class="app-header">
      <h1>ุฅุฏุงุฑุฉ ูุฎุฒูู ุงูุฑุงูุชุฑ</h1>
      <nav class="tabs header-tabs">
        <button class="tab active" data-tab="dashboard">ููุญุฉ ุงูุชุญูู</button>
        <button class="tab" data-tab="inventory">ุฅุฏุงุฑุฉ ุงููุฎุฒูู</button>
        <button class="tab" data-tab="sip">ุฅุถุงูุฉ SIP</button>
        <button class="tab" data-tab="reports">ุงูุชูุงุฑูุฑ ูุงูุณุฌูุงุช</button>
        <button class="tab" data-tab="settings">ุงูุฅุนุฏุงุฏุงุช</button>
      </nav>
    </header>

    <main class="tab-contents">
      <!-- Dashboard -->
      <section id="dashboard" class="tab-content shown">
        <div class="cards">
          <div class="card">
            <h3>ุงููุฎุฒูู ุงูุญุงูู</h3>
            <div class="kpi">
              <span id="currentStock">0</span>
              <span>/</span>
              <span id="maxCapacity">0</span>
            </div>
            <div id="stockStatus" class="status-badge">-</div>
          </div>

          <div class="card">
            <h3>ููุชุฑุงุฌ ุงููุงุจู (ุจุงููุชุฑ)</h3>
            <div class="kpi">
              <span id="cableCurrent">0</span>
              <span>/</span>
              <span id="cableCapacity">0</span>
            </div>
            <div id="cableStatus" class="status-badge">-</div>
          </div>

          <div class="card">
            <h3>ุฅุญุตุงุฆูุงุช ุงูููู</h3>
            <div class="kpi"><span id="todaySipCount">0</span> ุนูููุฉ SIP</div>
            <small id="todayDate"></small>
          </div>

          <div class="card quick-actions">
            <h3>ุฅุฌุฑุงุกุงุช ุณุฑูุนุฉ</h3>
            <div class="buttons">
              <button class="btn btn-primary" id="add5">+5</button>
              <button class="btn btn-primary" id="add10">+10</button>
              <button class="btn btn-danger" id="sub5">-5</button>
              <button class="btn btn-danger" id="sub10">-10</button>
            </div>
          </div>

          <div class="card">
            <h3>ุงูุญุงูุฉ ุงูุนุงูุฉ</h3>
            <canvas id="stockPie"></canvas>
          </div>
        </div>

        <div class="card">
          <h3>ุงุณุชููุงู ุงูุฃุณุจูุน</h3>
          <canvas id="weeklyChart" height="120"></canvas>
        </div>

        <div class="card">
          <h3>ุฌุฏูู ุงุณุชููุงู ุงูุฃุณุจูุน (SIP)</h3>
          <div class="table-wrap">
            <table id="weeklyTable" class="table">
              <thead>
                <tr>
                  <th>ุงูููู</th>
                  <th>ุงูุชุงุฑูุฎ</th>
                  <th>ุงูููุช</th>
                  <th>ุงูุดูุฑ</th>
                  <th>ุฑูู SIP</th>
                  <th>ูุทุฑุงุฌ ุงููุงุจู</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <div class="card">
          <h3>ุฃุญุฏุซ ุงูุนูููุงุช</h3>
          <ul id="recentLogs" class="list"></ul>
        </div>
      </section>

      <!-- Inventory -->
      <section id="inventory" class="tab-content">
        <div class="inventory-grid">
          <div class="card">
            <h3>ุงููููุฉ ูุงูุณุนุฉ</h3>
            <div class="row">
              <div class="col">
                <label>ุงููููุฉ ุงูุญุงููุฉ</label>
                <input id="invCurrent" type="number" min="0" />
              </div>
              <div class="col">
                <label>ุงูุณุนุฉ ุงููุตูู</label>
                <input id="invCapacity" type="number" min="1" />
              </div>
            </div>
            <div class="buttons mt">
              <button id="saveInv" class="btn btn-success">ุญูุธ</button>
              <button id="resetInv" class="btn btn-light">ุฅุนุงุฏุฉ ุชุนููู</button>
            </div>
          </div>

          <div class="card">
            <h3>ุชุนุฏูู ุณุฑูุน</h3>
            <div class="buttons">
              <button class="btn btn-primary" data-delta="5">+5</button>
              <button class="btn btn-primary" data-delta="10">+10</button>
              <button class="btn btn-danger" data-delta="-5">-5</button>
              <button class="btn btn-danger" data-delta="-10">-10</button>
            </div>
            <div class="row mt">
              <div class="col">
                <label>ูููุฉ ูุฎุตุตุฉ</label>
                <input id="customDelta" type="number" />
              </div>
              <div class="col">
                <label>&nbsp;</label>
                <button id="applyCustom" class="btn btn-primary">ุชุทุจูู</button>
              </div>
            </div>
          </div>

          <div class="card">
            <h3>ุณุฌู ุงูุชุนุฏููุงุช</h3>
            <div class="row mt">
              <div class="col">
                <label>ุนุฏุฏ ุงูุณุฌูุงุช ุงููุทููุจ ุญุฐููุง</label>
                <input id="invDeleteCount" type="number" min="1" placeholder="ูุซุงู: 5" />
              </div>
              <div class="col">
                <label>&nbsp;</label>
                <button id="deleteInvLogs" class="btn btn-danger">ุญุฐู</button>
              </div>
            </div>
            <ul id="invLogs" class="list"></ul>
          </div>

          <div class="card">
            <h3>ููุชุฑุงุฌ ุงููุงุจู (ุจุงููุชุฑ)</h3>
            <div class="row">
              <div class="col">
                <label>ุงููุชุจูู (ู)</label>
                <input id="invCableCurrent" type="number" min="0" />
              </div>
              <div class="col">
                <label>ุงูุณุนุฉ ุงููุตูู (ู)</label>
                <input id="invCableCapacity" type="number" min="0" />
              </div>
            </div>
            <div class="buttons mt">
              <button id="saveCable" class="btn btn-success">ุญูุธ</button>
              <button id="resetCable" class="btn btn-light">ุชุตููุฑ</button>
            </div>
            <div class="buttons mt">
              <button class="btn btn-primary" data-cdelta="5">+5ู</button>
              <button class="btn btn-primary" data-cdelta="10">+10ู</button>
              <button class="btn btn-danger" data-cdelta="-5">-5ู</button>
              <button class="btn btn-danger" data-cdelta="-10">-10ู</button>
            </div>
            <div class="row mt">
              <div class="col">
                <label>ูููุฉ ูุฎุตุตุฉ (ู)</label>
                <input id="customCableDelta" type="number" />
              </div>
              <div class="col">
                <label>&nbsp;</label>
                <button id="applyCustomCable" class="btn btn-primary">ุชุทุจูู</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- SIP Add -->
      <section id="sip" class="tab-content">
        <div class="card">
          <h3>ุฅุถุงูุฉ ุฑูู SIP ุฌุฏูุฏ</h3>
          <form id="sipForm" class="compact-form">
            <div class="sub-tabs">
              <button class="sub-tab active" data-subtab="sip-all">ุงููููุฐุฌ</button>
            </div>

            <div class="sub-tab-contents">
              <section id="sip-all" class="sub-tab-content shown">
                <div class="table-wrap">
                  <table class="table compact"><tbody>
                    <tr>
                      <td style="width:200px"><label for="sipNumber">ุงุฏุฎูู SIP</label></td>
                      <td><input id="sipNumber" inputmode="numeric" pattern="^[0-9]{3,15}$" placeholder="ุงุฏุฎูู SIP" required /></td>
                    </tr>
                    <tr>
                      <td><label for="sipNote">ูุทุฑุงุฌ ุงููุงุจู</label></td>
                      <td><input id="sipNote" placeholder="ูุทุฑุงุฌ ุงููุงุจู" /></td>
                    </tr>
                    <tr>
                      <td><label for="sipCustomDateToggle">ุชุนููู ุชุงุฑูุฎ/ููุช ูุฎุตุต</label></td>
                      <td><input id="sipCustomDateToggle" type="checkbox" /></td>
                    </tr>
                    <tr>
                      <td><label for="sipDateTime">ุงูุชุงุฑูุฎ ูุงูููุช</label></td>
                      <td><input id="sipDateTime" type="datetime-local" disabled /></td>
                    </tr>
                    <tr>
                      <td><label>ููู ุณุงุจู</label></td>
                      <td><button id="sipDateBackBtn" type="button" class="btn btn-light" disabled>โ๏ธ ููู ุณุงุจู</button></td>
                    </tr>
                  </tbody></table>
                </div>
              </section>
            </div>
            <div class="buttons mt">
              <button class="btn btn-success" type="submit">ุญูุธ</button>
              <button class="btn btn-light" type="reset">ุฅูุบุงุก</button>
            </div>
          </form>
          <div id="sipImpact" class="hint"></div>
        </div>

        <div class="card">
          <h3>ุจุญุซ ูุชุตููุฉ</h3>
          <div class="row">
            <div class="col-4 col"><input id="searchSip" placeholder="ุจุญุซ ุนู SIP" /></div>
            <div class="col-4 col"><input id="noteFilter" placeholder="ุชุตููุฉ ุจุงูููุงุญุธุฉ" /></div>
            <div class="col-2 col"><input id="fromDate" type="date" /></div>
            <div class="col-2 col"><input id="toDate" type="date" /></div>
          </div>
          <div class="buttons mt">
            <button class="btn btn-light" id="rangeToday">ุงูููู</button>
            <button class="btn btn-light" id="rangeWeek">ูุฐุง ุงูุฃุณุจูุน</button>
            <button class="btn btn-light" id="rangeMonth">ูุฐุง ุงูุดูุฑ</button>
            <button class="btn" id="clearRange">ูุณุญ ุงูุชุญุฏูุฏ</button>
          </div>
          <ul id="sipList" class="list"></ul>
        </div>
      </section>

      <!-- Reports -->
      <section id="reports" class="tab-content">
        <div class="card">
          <h3>ุงูุณุฌูุงุช</h3>
          <div class="row">
            <div class="col"><input id="searchLog" placeholder="ุจุญุซ ูู ุงูุณุฌูุงุช" /></div>
            <div class="col"><input id="logFrom" type="date" /></div>
            <div class="col"><input id="logTo" type="date" /></div>
          </div>
          <div class="buttons mt">
            <button id="exportTodaySips" class="btn btn-light">ุชูุฑูุฑ ุงูููู (CSV)</button>
            <button id="exportWeekSips" class="btn btn-primary">ุชูุฑูุฑ ุงูุฃุณุจูุน (CSV)</button>
          </div>
          <ul id="allLogs" class="list"></ul>
        </div>
      </section>

      <!-- Settings -->
      <section id="settings" class="tab-content">
        <div class="card">
          <h3>ุฎูุงุฑุงุช ุงูุนุฑุถ</h3>
          <div class="row">
            <div class="col">
              <label>ุชูุนูู ุงููุถุน ุงูุฏุงูู</label>
              <input id="enableDark" type="checkbox" />
            </div>
            <div class="col">
              <label>ุชูุนูู ูููุฉ ูุฑูุฑ</label>
              <input id="enablePassword" type="checkbox" />
            </div>
            <div class="col" id="passwordWrap" style="display:none;">
              <label>ูููุฉ ุงููุฑูุฑ</label>
              <input id="appPassword" type="password" />
            </div>
          </div>
          <div class="buttons mt">
            <button id="saveSettings" class="btn btn-success">ุญูุธ ุงูุฅุนุฏุงุฏุงุช</button>
          </div>
        </div>

        <div class="card">
          <h3>ุนูููุงุช ุงููุธุงู</h3>
          <div class="table-wrap">
            <table class="table">
              <thead>
                <tr>
                  <th>ุงูุนูููุฉ</th>
                  <th>ุงูุชุญูู</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>ุงูููู</td>
                  <td>
                    <button id="lockBtn" class="btn btn-light" title="ููู ุงูุชุทุจูู (L)">๐ ููู</button>
                  </td>
                </tr>
                <tr>
                  <td>ุงูุชุตุฏูุฑ</td>
                  <td>
                    <button id="exportBtn" class="btn btn-light" title="ุชุตุฏูุฑ ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ">โฌ๏ธ ุชุตุฏูุฑ</button>
                  </td>
                </tr>
                <tr>
                  <td>Excel</td>
                  <td>
                    <button id="exportXlsxBtn" class="btn btn-primary" title="ุชุตุฏูุฑ ุฅูู Excel (.xlsx)">๐ Excel</button>
                  </td>
                </tr>
                <tr>
                  <td>ุงูุงุณุชูุฑุงุฏ</td>
                  <td>
                    <label class="btn btn-light file-label" title="ุงุณุชูุฑุงุฏ ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ">
                      โฌ๏ธ ุงุณุชูุฑุงุฏ
                      <input id="importInput" type="file" accept="application/json,text/csv" hidden />
                    </label>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </section>
    </main>
  </div>

  <div id="toastContainer"></div>
  <div id="confirmModal" class="modal hidden">
    <div class="modal-content">
      <p id="confirmMessage">ูู ุฃูุช ูุชุฃูุฏุ</p>
      <div class="buttons">
        <button id="confirmYes" class="btn btn-success">ุชุฃููุฏ</button>
        <button id="confirmNo" class="btn btn-light">ุฅูุบุงุก</button>
      </div>
    </div>
  </div>

  <div id="lockScreen" class="modal hidden">
    <div class="modal-content">
      <h3>ุงูุชุทุจูู ูููู</h3>
      <input id="unlockPassword" type="password" placeholder="ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ" />
      <div class="buttons mt">
        <button id="unlockBtn" class="btn btn-primary">ูุชุญ</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
